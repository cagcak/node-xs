{"version":3,"file":"node-xs.js","mappings":"CAAA,SAA2CA,EAAMC,GAC1B,iBAAZC,SAA0C,iBAAXC,OACxCA,OAAOD,QAAUD,IACQ,mBAAXG,QAAyBA,OAAOC,IAC9CD,OAAO,SAAU,GAAIH,GACK,iBAAZC,QACdA,QAAgB,OAAID,IAEpBD,EAAa,OAAIC,GAClB,CATD,CASGK,QAAQ,I,waCTX,W,+ECEA,kBACEC,EACAC,GAEA,OAAO,SAAUC,EAAaC,GAC5B,IAAIC,EAAWF,EAAOC,GAEtB,OAAOE,OAAOC,eAAeJ,EAAQC,EAAa,CAChDI,IAAMC,IACJJ,EAAQ,IAAoB,EAE9BK,IAAK,IAASL,GAElB,CACF,C,eChBA,eACA,SAEA,UAAS,CACPM,MAAQV,GAAmB,IAAI,EAAAW,aAAaX,GAC5CY,OAAA,EAAAA,O,gZCLF,W,8bCEA,qBAIEC,YAAoBC,GAAA,KAAAA,OAAAA,EAHZ,KAAAd,MAAQe,KAAKC,UAAUC,QAAQC,IAAIC,OACnC,KAAAC,aAAe,CAAC,EAGjBH,QAAQC,IAAIC,OAAUE,KAAKP,OAErBO,KAAKP,SACdO,KAAKC,MAAQD,KAAKP,QAFlBO,KAAKC,MAAQD,KAAKD,YAItB,CAEYE,YACV,OACGP,KAAKQ,MAAON,QAAQC,IAAIC,OAAoB,OAAeE,KAAKrB,KAErE,CAEYsB,UAAME,GAGhB,GAFAH,KAAKrB,MAAQwB,EAEE,OAAXA,GAA2C,SAAvBA,EAMxBP,QAAQC,IAAIC,MAAQJ,KAAKC,UAAUK,KAAKrB,WANxC,CACE,MAAM,EAAoBiB,QAAQC,KAA5B,MAAEC,GAAK,EAAKM,EAAG,IAAf,WACNR,QAAQC,IAAMO,C,CAKlB,CAEAC,OAAuBC,GACrB,OAAKA,EAGON,KAAKC,OAAWD,KAAKC,MAAcK,GAKvCN,KAAKC,MAAcK,IAJzBC,QAAQC,KAAK,mBACN,OAJPD,QAAQC,KAAK,qBACN,KAOX,CAEAC,MAAeH,EAAcvB,GACtBuB,GAAQvB,EAObiB,KAAKC,MAAQ,OAAH,wBACLD,KAAKrB,OAAK,CACb,CAAC2B,GAAMvB,IARPwB,QAAQC,KACN,yCAAyCF,EAAII,uBAAuB3B,IAS1E,CAEA4B,MAAML,GACJ,GAAKN,KAAKC,MAAV,CAKA,GACEK,GACAtB,OAAO4B,KAAKZ,KAAKC,OAAOY,SAASP,IACjCN,KAAKC,MAAMK,GAOX,OALAN,KAAKC,MAAQjB,OAAO8B,QAAQd,KAAKC,OAC9Bc,QAAO,EAAEC,EAAMC,KAASD,IAASV,IACjCY,QAAO,CAACC,GAAMb,EAAKW,KAAU,OAAD,wBAAME,GAAG,CAAE,CAACb,GAAMW,KAAQ,CAAC,QAE1DV,QAAQa,IAAI,GAAGd,qCAIjBN,KAAKC,MAAQ,KACbM,QAAQa,IAAI,6B,MAlBVb,QAAQC,KAAK,mBAmBjB,E,GC9EEa,EAA2B,CAAC,ECEhC,IAAIC,EDCJ,SAASC,EAAoBC,GAE5B,IAAIC,EAAeJ,EAAyBG,GAC5C,QAAqBE,IAAjBD,EACH,OAAOA,EAAanD,QAGrB,IAAIC,EAAS8C,EAAyBG,GAAY,CAGjDlD,QAAS,CAAC,GAOX,OAHAqD,EAAoBH,GAAUI,KAAKrD,EAAOD,QAASC,EAAQA,EAAOD,QAASiD,GAGpEhD,EAAOD,OACf,CCnB0BiD,CAAoB,I","sources":["webpack://NodeXs/webpack/universalModuleDefinition","webpack://NodeXs/./src/decorators/index.ts","webpack://NodeXs/./src/decorators/select.decorator.ts","webpack://NodeXs/./src/index.ts","webpack://NodeXs/./src/modules/index.ts","webpack://NodeXs/./src/modules/state-machine.ts","webpack://NodeXs/webpack/bootstrap","webpack://NodeXs/webpack/startup"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"NodeXs\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"NodeXs\"] = factory();\n\telse\n\t\troot[\"NodeXs\"] = factory();\n})(global, () => {\nreturn ","export * from \"./select.decorator\";\n","import { DefaultState, Options } from \"../models\";\n\nexport function Select<T = DefaultState>(\n  state?: T,\n  options?: Options\n): PropertyDecorator {\n  return function (target: any, propertyKey: string | symbol) {\n    let value: T = target[propertyKey];\n\n    return Object.defineProperty(target, propertyKey, {\n      set: (newValue: string) => {\n        value = null as unknown as T;\n      },\n      get: (): T => value,\n    });\n  };\n}\n","import { Select } from \"./decorators\";\nimport { StateMachine } from \"./modules\";\n\nexport = {\n  Store: (state: unknown) => new StateMachine(state),\n  Select,\n};\n","export * from \"./state-machine\";\n","import { DefaultState } from \"../models\";\n\nexport class StateMachine<T = DefaultState> {\n  private state = JSON.stringify(process.env.STATE) as unknown as T;\n  private initialState = {} as T;\n\n  constructor(private _state?: T) {\n    if (!process.env.STATE && !this._state) {\n      this.store = this.initialState;\n    } else if (this._state) {\n      this.store = this._state;\n    }\n  }\n\n  private get store(): T {\n    return (\n      (JSON.parse((process.env.STATE as string) || \"{}\") as T) || this.state\n    );\n  }\n\n  private set store(state_: T) {\n    this.state = state_;\n\n    if (state_ === null || (state_ as unknown) === \"null\") {\n      const { STATE, ...ENV } = process.env;\n      process.env = ENV;\n      return;\n    }\n\n    process.env.STATE = JSON.stringify(this.state);\n  }\n\n  select<K = T[keyof T]>(key: keyof T): K {\n    if (!key) {\n      console.warn(\"No key specified!\");\n      return null as unknown as K;\n    } else if (!this.store || !(this.store as any)[key]) {\n      console.warn(\"No value found!\");\n      return null as unknown as K;\n    }\n\n    return (this.store as any)[key] as unknown as K;\n  }\n\n  patch<V = any>(key: keyof T, value: V) {\n    if (!key || !value) {\n      console.warn(\n        `Invalid key or value specified:\\nkey: ${key.toString()},\\nvalue: ${value}`\n      );\n      return;\n    }\n\n    this.store = {\n      ...this.state,\n      [key]: value,\n    };\n  }\n\n  clean(key?: keyof T) {\n    if (!this.store) {\n      console.warn(\"No store present\");\n      return;\n    }\n\n    if (\n      key &&\n      Object.keys(this.store).includes(key as string) &&\n      this.store[key]\n    ) {\n      this.store = Object.entries(this.store)\n        .filter(([_key, val]) => _key !== key)\n        .reduce((acc, [key, val]) => ({ ...acc, [key]: val }), {} as T);\n\n      console.log(`${key} has been removed from the store`);\n      return;\n    }\n\n    this.store = null as unknown as T;\n    console.log(\"The store has been removed\");\n  }\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(22);\n"],"names":["root","factory","exports","module","define","amd","global","state","options","target","propertyKey","value","Object","defineProperty","set","newValue","get","Store","StateMachine","Select","constructor","_state","JSON","stringify","process","env","STATE","initialState","this","store","parse","state_","ENV","select","key","console","warn","patch","toString","clean","keys","includes","entries","filter","_key","val","reduce","acc","log","__webpack_module_cache__","__webpack_exports__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","call"],"sourceRoot":""}